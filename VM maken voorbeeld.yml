- name: Authenticate with Azure
  azure.azcollection.azure_rm_virtualmachine:
    client_id: "{{ azure_credentials.client_id }}"
    secret: "{{ azure_credentials.secret }}"
    tenant: "{{ azure_credentials.tenant }}"
    subscription_id: "{{ azure_credentials.subscription_id }}"
    state: present
    resource_group: "{{ vm_parameters.resource_group }}"
    name: "{{ vm_parameters.vm_name }}"
    vm_size: "{{ vm_parameters.vm_size }}"
    admin_username: "{{ vm_parameters.admin_username }}"
    admin_password: "{{ admin_password }}"
    network_interfaces:
      - name: "{{ vm_parameters.network_interface_name }}"
    os_type: "{{ vm_parameters.os_type }}"
    image:
      offer: "{{ vm_parameters.image.offer }}"
      publisher: "{{ vm_parameters.image.publisher }}"
      sku: "{{ vm_parameters.image.sku }}"
      version: "{{ vm_parameters.image.version }}"
